#!/usr/bin/env node

const fs = require('fs');
const path = require('path');

console.log('ðŸ“Š Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆç”¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆCSVã‚’ä½œæˆä¸­...\n');

// ã‚ˆã‚Šå¤šãã®ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ
const vocabularyData = [
  // HSK 1ãƒ¬ãƒ™ãƒ«
  ['ã“ã‚“ã«ã¡ã¯', 'ä½ å¥½', 'nÇ hÇŽo', 'ä½ å¥½ï¼å¾ˆé«˜å…´è§åˆ°ä½ ã€‚', 'nÇ hÇŽo! hÄ›n gÄo xÃ¬ng jiÃ n dÃ o nÇ.', 1],
  ['ã‚ã‚ŠãŒã¨ã†', 'è°¢è°¢', 'xiÃ¨ xie', 'è°¢è°¢ä½ çš„å¸®åŠ©ã€‚', 'xiÃ¨ xie nÇ de bÄng zhÃ¹.', 1],
  ['ã™ã¿ã¾ã›ã‚“', 'å¯¹ä¸èµ·', 'duÃ¬ bu qÇ', 'å¯¹ä¸èµ·ï¼Œæˆ‘æ¥æ™šäº†ã€‚', 'duÃ¬ bu qÇ, wÇ’ lÃ¡i wÇŽn le.', 1],
  ['ã¯ã„', 'æ˜¯', 'shÃ¬', 'æ˜¯çš„ï¼Œæˆ‘æ˜Žç™½äº†ã€‚', 'shÃ¬ de, wÇ’ mÃ­ng bÃ¡i le.', 1],
  ['ã„ã„ãˆ', 'ä¸æ˜¯', 'bÃ¹ shÃ¬', 'ä¸æ˜¯ï¼Œæˆ‘ä¸çŸ¥é“ã€‚', 'bÃ¹ shÃ¬, wÇ’ bÃ¹ zhÄ« dÃ o.', 1],
  ['ç§', 'æˆ‘', 'wÇ’', 'æˆ‘æ˜¯ä¸­å›½äººã€‚', 'wÇ’ shÃ¬ zhÅng guÃ³ rÃ©n.', 1],
  ['ã‚ãªãŸ', 'ä½ ', 'nÇ', 'ä½ å«ä»€ä¹ˆåå­—ï¼Ÿ', 'nÇ jiÃ o shÃ©n me mÃ­ng zi?', 1],
  ['å½¼', 'ä»–', 'tÄ', 'ä»–æ˜¯æˆ‘çš„æœ‹å‹ã€‚', 'tÄ shÃ¬ wÇ’ de pÃ©ng you.', 1],
  ['å½¼å¥³', 'å¥¹', 'tÄ', 'å¥¹å¾ˆæ¼‚äº®ã€‚', 'tÄ hÄ›n piÃ o liang.', 1],
  ['å®¶', 'å®¶', 'jiÄ', 'æˆ‘çš„å®¶å¾ˆå¤§ã€‚', 'wÇ’ de jiÄ hÄ›n dÃ .', 1],
  ['å­¦æ ¡', 'å­¦æ ¡', 'xuÃ© xiÃ o', 'å­¦æ ¡åœ¨å“ªé‡Œï¼Ÿ', 'xuÃ© xiÃ o zÃ i nÇŽ lÇ?', 1],
  ['å…ˆç”Ÿ', 'è€å¸ˆ', 'lÇŽo shÄ«', 'è€å¸ˆå¾ˆå¥½ã€‚', 'lÇŽo shÄ« hÄ›n hÇŽo.', 1],
  ['å­¦ç”Ÿ', 'å­¦ç”Ÿ', 'xuÃ© sheng', 'æˆ‘æ˜¯å­¦ç”Ÿã€‚', 'wÇ’ shÃ¬ xuÃ© sheng.', 1],
  ['æœ¬', 'ä¹¦', 'shÅ«', 'è¿™æœ¬ä¹¦å¾ˆæœ‰è¶£ã€‚', 'zhÃ¨ bÄ›n shÅ« hÄ›n yÇ’u qÃ¹.', 1],
  ['æ°´', 'æ°´', 'shuÇ', 'æˆ‘æƒ³å–æ°´ã€‚', 'wÇ’ xiÇŽng hÄ“ shuÇ.', 1],
  ['ãŠé‡‘', 'é’±', 'qiÃ¡n', 'è¿™ä¸ªå¤šå°‘é’±ï¼Ÿ', 'zhÃ¨ ge duÅ shao qiÃ¡n?', 1],
  ['æ™‚é–“', 'æ—¶é—´', 'shÃ­ jiÄn', 'çŽ°åœ¨å‡ ç‚¹ï¼Ÿ', 'xiÃ n zÃ i jÇ diÇŽn?', 1],
  ['ä»Šæ—¥', 'ä»Šå¤©', 'jÄ«n tiÄn', 'ä»Šå¤©å¤©æ°”å¾ˆå¥½ã€‚', 'jÄ«n tiÄn tiÄn qÃ¬ hÄ›n hÇŽo.', 1],
  ['æ˜Žæ—¥', 'æ˜Žå¤©', 'mÃ­ng tiÄn', 'æ˜Žå¤©è§ï¼', 'mÃ­ng tiÄn jiÃ n!', 1],
  ['æ˜¨æ—¥', 'æ˜¨å¤©', 'zuÃ³ tiÄn', 'æ˜¨å¤©æˆ‘å¾ˆå¿™ã€‚', 'zuÃ³ tiÄn wÇ’ hÄ›n mÃ¡ng.', 1],
  
  // HSK 2ãƒ¬ãƒ™ãƒ«
  ['å¥½ã', 'å–œæ¬¢', 'xÇ huan', 'æˆ‘å–œæ¬¢ä¸­å›½èœã€‚', 'wÇ’ xÇ huan zhÅng guÃ³ cÃ i.', 2],
  ['å«Œã„', 'ä¸å–œæ¬¢', 'bÃ¹ xÇ huan', 'æˆ‘ä¸å–œæ¬¢ä¸‹é›¨ã€‚', 'wÇ’ bÃ¹ xÇ huan xiÃ  yÇ”.', 2],
  ['æ¬²ã—ã„', 'æƒ³è¦', 'xiÇŽng yÃ o', 'æˆ‘æƒ³è¦ä¸€æ¯å’–å•¡ã€‚', 'wÇ’ xiÇŽng yÃ o yÄ« bÄ“i kÄ fÄ“i.', 2],
  ['å¿…è¦', 'éœ€è¦', 'xÅ« yÃ o', 'æˆ‘éœ€è¦ä½ çš„å¸®åŠ©ã€‚', 'wÇ’ xÅ« yÃ o nÇ de bÄng zhÃ¹.', 2],
  ['ã§ãã‚‹', 'å¯ä»¥', 'kÄ› yÇ', 'æˆ‘å¯ä»¥å¸®ä½ å—ï¼Ÿ', 'wÇ’ kÄ› yÇ bÄng nÇ ma?', 2],
  ['ç†è§£ã™ã‚‹', 'æ˜Žç™½', 'mÃ­ng bÃ¡i', 'æˆ‘æ˜Žç™½ä½ çš„æ„æ€ã€‚', 'wÇ’ mÃ­ng bÃ¡i nÇ de yÃ¬ si.', 2],
  ['çŸ¥ã£ã¦ã„ã‚‹', 'çŸ¥é“', 'zhÄ« dÃ o', 'æˆ‘çŸ¥é“è¿™ä¸ªåœ°æ–¹ã€‚', 'wÇ’ zhÄ« dÃ o zhÃ¨ ge dÃ¬ fang.', 2],
  ['è¦šãˆã¦ã„ã‚‹', 'è®°å¾—', 'jÃ¬ de', 'æˆ‘è®°å¾—ä½ çš„åå­—ã€‚', 'wÇ’ jÃ¬ de nÇ de mÃ­ng zi.', 2],
  ['å¿˜ã‚Œã‚‹', 'å¿˜è®°', 'wÃ ng jÃ¬', 'æˆ‘å¿˜è®°å¸¦é’¥åŒ™äº†ã€‚', 'wÇ’ wÃ ng jÃ¬ dÃ i yÃ o shi le.', 2],
  ['å‹‰å¼·ã™ã‚‹', 'å­¦ä¹ ', 'xuÃ© xÃ­', 'æˆ‘åœ¨å­¦ä¹ ä¸­æ–‡ã€‚', 'wÇ’ zÃ i xuÃ© xÃ­ zhÅng wÃ©n.', 2],
  ['åƒã', 'å·¥ä½œ', 'gÅng zuÃ²', 'æˆ‘åœ¨é“¶è¡Œå·¥ä½œã€‚', 'wÇ’ zÃ i yÃ­n hÃ¡ng gÅng zuÃ².', 2],
  ['ä¼‘ã‚€', 'ä¼‘æ¯', 'xiÅ« xi', 'æˆ‘æƒ³ä¼‘æ¯ä¸€ä¸‹ã€‚', 'wÇ’ xiÇŽng xiÅ« xi yÄ« xiÃ .', 2],
  ['è²·ã†', 'ä¹°', 'mÇŽi', 'æˆ‘æƒ³ä¹°è¿™ä¸ªã€‚', 'wÇ’ xiÇŽng mÇŽi zhÃ¨ ge.', 2],
  ['å£²ã‚‹', 'å–', 'mÃ i', 'è¿™é‡Œå–ä»€ä¹ˆï¼Ÿ', 'zhÃ¨ lÇ mÃ i shÃ©n me?', 2],
  ['é£Ÿã¹ã‚‹', 'åƒ', 'chÄ«', 'ä½ åƒæ—©é¥­äº†å—ï¼Ÿ', 'nÇ chÄ« zÇŽo fÃ n le ma?', 2],
  ['é£²ã‚€', 'å–', 'hÄ“', 'æˆ‘æƒ³å–èŒ¶ã€‚', 'wÇ’ xiÇŽng hÄ“ chÃ¡.', 2],
  ['æ–™ç†', 'èœ', 'cÃ i', 'ä¸­å›½èœå¾ˆå¥½åƒã€‚', 'zhÅng guÃ³ cÃ i hÄ›n hÇŽo chÄ«.', 2],
  ['ç¾Žå‘³ã—ã„', 'å¥½åƒ', 'hÇŽo chÄ«', 'è¿™ä¸ªå¾ˆå¥½åƒã€‚', 'zhÃ¨ ge hÄ›n hÇŽo chÄ«.', 2],
  ['é«˜ã„', 'è´µ', 'guÃ¬', 'è¿™ä¸ªå¤ªè´µäº†ã€‚', 'zhÃ¨ ge tÃ i guÃ¬ le.', 2],
  ['å®‰ã„', 'ä¾¿å®œ', 'piÃ¡n yi', 'è¿™ä¸ªå¾ˆä¾¿å®œã€‚', 'zhÃ¨ ge hÄ›n piÃ¡n yi.', 2],
  
  // HSK 3ãƒ¬ãƒ™ãƒ«
  ['åŠªåŠ›ã™ã‚‹', 'åŠªåŠ›', 'nÇ” lÃ¬', 'æˆ‘ä¼šåŠªåŠ›å­¦ä¹ çš„ã€‚', 'wÇ’ huÃ¬ nÇ” lÃ¬ xuÃ© xÃ­ de.', 3],
  ['æ±ºå®šã™ã‚‹', 'å†³å®š', 'juÃ© dÃ¬ng', 'æˆ‘å†³å®šåŽ»åŒ—äº¬ã€‚', 'wÇ’ juÃ© dÃ¬ng qÃ¹ bÄ›i jÄ«ng.', 3],
  ['æº–å‚™ã™ã‚‹', 'å‡†å¤‡', 'zhÇ”n bÃ¨i', 'æˆ‘åœ¨å‡†å¤‡è€ƒè¯•ã€‚', 'wÇ’ zÃ i zhÇ”n bÃ¨i kÇŽo shÃ¬.', 3],
  ['èª¬æ˜Žã™ã‚‹', 'è§£é‡Š', 'jiÄ› shÃ¬', 'è¯·è§£é‡Šä¸€ä¸‹è¿™ä¸ªé—®é¢˜ã€‚', 'qÇng jiÄ› shÃ¬ yÄ« xiÃ  zhÃ¨ ge wÃ¨n tÃ­.', 3],
  ['ç™ºè¦‹ã™ã‚‹', 'å‘çŽ°', 'fÄ xiÃ n', 'æˆ‘å‘çŽ°äº†ä¸€ä¸ªé—®é¢˜ã€‚', 'wÇ’ fÄ xiÃ n le yÄ« ge wÃ¨n tÃ­.', 3],
  ['æ¯”è¼ƒã™ã‚‹', 'æ¯”è¾ƒ', 'bÇ jiÃ o', 'è¯·æ¯”è¾ƒè¿™ä¸¤ä¸ªäº§å“ã€‚', 'qÇng bÇ jiÃ o zhÃ¨ liÇŽng ge chÇŽn pÇn.', 3],
  ['é¸æŠžã™ã‚‹', 'é€‰æ‹©', 'xuÇŽn zÃ©', 'ä½ å¯ä»¥é€‰æ‹©ä½ å–œæ¬¢çš„ã€‚', 'nÇ kÄ› yÇ xuÇŽn zÃ© nÇ xÇ huan de.', 3],
  ['ææ¡ˆã™ã‚‹', 'å»ºè®®', 'jiÃ n yÃ¬', 'æˆ‘å»ºè®®ä½ æ—©ç‚¹ä¼‘æ¯ã€‚', 'wÇ’ jiÃ n yÃ¬ nÇ zÇŽo diÇŽn xiÅ« xi.', 3],
  ['çµŒé¨“', 'ç»éªŒ', 'jÄ«ng yÃ n', 'è¿™æ˜¯å¾ˆå¥½çš„ç»éªŒã€‚', 'zhÃ¨ shÃ¬ hÄ›n hÇŽo de jÄ«ng yÃ n.', 3],
  ['æ©Ÿä¼š', 'æœºä¼š', 'jÄ« huÃ¬', 'è¿™æ˜¯ä¸€ä¸ªå¥½æœºä¼šã€‚', 'zhÃ¨ shÃ¬ yÄ« ge hÇŽo jÄ« huÃ¬.', 3]
];

// CSVãƒ˜ãƒƒãƒ€ãƒ¼
const headers = ['æ—¥æœ¬èªž', 'ä¸­å›½èªž', 'æ‹¼éŸ³', 'ä¾‹æ–‡', 'ä¾‹æ–‡æ‹¼éŸ³', 'HSKãƒ¬ãƒ™ãƒ«'];

// CSVãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆã«å¤‰æ›
const csvContent = [headers, ...vocabularyData]
  .map(row => row.map(cell => `"${cell}"`).join(','))
  .join('\n');

// ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜
const outputPath = path.join(process.cwd(), 'vocabulary-template.csv');
fs.writeFileSync(outputPath, csvContent, 'utf8');

console.log(`âœ… ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆCSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã—ãŸ: ${outputPath}`);
console.log(`ðŸ“ ${vocabularyData.length}å€‹ã®å˜èªžãŒå«ã¾ã‚Œã¦ã„ã¾ã™\n`);

console.log('æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—:');
console.log('1. vocabulary-template.csvã‚’Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆ');
console.log('2. ã¾ãŸã¯æ‰‹å‹•ã§ãƒ‡ãƒ¼ã‚¿ã‚’ã‚³ãƒ”ãƒ¼&ãƒšãƒ¼ã‚¹ãƒˆ');
console.log('3. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’å…±æœ‰è¨­å®šã«ã™ã‚‹');
console.log('4. npm run setup-sheets ã§APIã‚­ãƒ¼ã‚’è¨­å®š\n');

console.log('HSKãƒ¬ãƒ™ãƒ«åˆ¥å†…è¨³:');
const levelCounts = vocabularyData.reduce((acc, row) => {
  const level = row[5];
  acc[level] = (acc[level] || 0) + 1;
  return acc;
}, {});

Object.entries(levelCounts).forEach(([level, count]) => {
  console.log(`  HSK ${level}: ${count}å€‹`);
});